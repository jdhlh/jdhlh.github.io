<!DOCTYPE html>
<html>
<head>
    <title>Aippt Iframe SDK</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.0.0/crypto-js.min.js"></script>
</head>
<body>
    <!-- 加载 SDK -->
    <script src="https://api-static.aippt.cn/aippt-iframe-sdk.js"></script>
    <script>
        // 你的 JavaScript 代码
        window.onload = function() {
            var custom_generate_content = '```
# 环境保护

## 1. 环境保护概述
### 1.1 环境保护的含义与重要性
#### 1.1.1 环境保护的定义
#### 1.1.2 环境保护对人类社会的影响
#### 1.1.3 环境保护与可持续发展的关系
### 1.2 环境问题的现状
#### 1.2.1 全球环境问题概述
#### 1.2.2 我国环境问题现状
#### 1.2.3 环境问题的危害
### 1.3 环境保护的历史与进展
#### 1.3.1 国际环境保护发展历程
#### 1.3.2 我国环境保护政策演变
#### 1.3.3 环境保护取得的成果

## 2. 环境保护法律法规
### 2.1 国际环境保护法规
#### 2.1.1 国际环境公约与协议
#### 2.1.2 国际环境保护法律体系
#### 2.1.3 国际环境保护法规的执行与监督
### 2.2 我国环境保护法律法规
#### 2.2.1 我国环境保护法律体系
#### 2.2.2 环境保护法律法规的实施
#### 2.2.3 环境保护法律法规的改进与完善
### 2.3 环境保护执法与监管
#### 2.3.1 环境保护执法机构
#### 2.3.2 环境保护执法手段
#### 2.3.3 环境保护监管体系

## 3. 环境保护技术与管理
### 3.1 环境保护技术
#### 3.1.1 污染防治技术
#### 3.1.2 资源循环利用技术
#### 3.1.3 生态修复技术
### 3.2 环境保护管理
#### 3.2.1 环境保护管理体制
#### 3.2.2 环境保护政策制定
#### 3.2.3 环境保护项目管理
### 3.3 环境保护宣传教育
#### 3.3.1 环境保护宣传教育策略
#### 3.3.2 环境保护公众参与
#### 3.3.3 环境保护宣传教育效果评估

## 4. 环境保护产业与发展
### 4.1 环境保护产业发展现状
#### 4.1.1 国际环境保护产业发展趋势
#### 4.1.2 我国环境保护产业发展现状
#### 4.1.3 环境保护产业的市场前景
### 4.2 环境保护产业政策
#### 4.2.1 国际环境保护产业政策
#### 4.2.2 我国环境保护产业政策
#### 4.2.3 环境保护产业政策的影响
### 4.3 环境保护产业技术创新
#### 4.3.1 环境保护技术发展趋势
#### 4.3.2 环境保护技术成果转化
#### 4.3.3 环境保护产业技术创新策略

## 5. 环境保护国际合作与交流
### 5.1 国际环境保护合作机制
#### 5.1.1 全球环境治理机制
#### 5.1.2 区域环境保护合作
#### 5.1.3 国际环境保护合作项目
### 5.2 国际环境保护交流
#### 5.2.1 国际环境保护学术交流
#### 5.2.2 国际环境保护技术交流
#### 5.2.3 国际环境保护政策交流
### 5.3 环境保护国际援助与合作
#### 5.3.1 环境保护国际援助政策
#### 5.3.2 环境保护国际援助项目
#### 5.3.3 环境保护国际合作成果

## 6. 环境保护未来展望
### 6.1 环境保护发展趋势
#### 6.1.1 环境保护技术发展趋势
#### 6.1.2 环境保护政策发展趋势
#### 6.1.3 环境保护产业发展趋势
### 6.2 环境保护挑战与应对
#### 6.2.1 环境保护面临的挑战
#### 6.2.2 环境保护应对策略
#### 6.2.3 环境保护国际合作展望
### 6.3 环境保护与人类命运共同体
#### 6.3.1 人类命运共同体的理念
#### 6.3.2 环境保护在人类命运共同体中的作用
#### 6.3.3 构建人类命运共同体的环境保护路径
```'
            const apiSecret = '2YdWhPr6WYyWkPgZYQSuEILduOe4MvyI'; // Replace with your actual API secret
            const apiKey = '6684d4c711462'; // Replace with your actual API key
            const currentSeconds = Math.floor(Date.now() / 1000);
            const body = 'GET@/api/grant/code/@' + currentSeconds;

            // Generate HMAC-SHA1 signature
            const hash = CryptoJS.HmacSHA1(body, apiSecret);
            const base64Encoded = CryptoJS.enc.Base64.stringify(hash);

            // 构建请求 URL 和查询参数
            const url = new URL('https://co.aippt.cn/api/grant/code');
            url.searchParams.append('uid', '2');
            url.searchParams.append('channel', '');

            // Construct headers
            const headers = {
                'x-api-key': apiKey,
                'x-timestamp': currentSeconds,
                'x-signature': base64Encoded
            };

            // Send request
            fetch(url, {
                method: 'GET',
                headers: headers
            })
            .then(response => response.json())
            .then(data => {
                const m_code = data.data.code;
                // 确保 SDK 加载完成后再执行代码
                if (typeof AipptIframe !== 'undefined') {
                    console.log('AipptIframe SDK is loaded');
                    // 初始化 SDK 或调用 SDK 提供的方法
                    try {
                    AipptIframe.show({
                    appkey: '6684d4c711462',
                    channel: '',
                    code: m_code,
                    editorModel: true,
                    routerOptions: {
                    list: ['workspace', 'generate', 'editor'],
                    // 存在editor 并且存在id的情况下 则直接跳转至编辑器页面
                    //  editor: {
                    //      id: 705734
                    //   }
                    },
                    options: {
                    // download_mode: 0 // 只发送消息通知，但不会进行自动下载，包含可下载地址
                    // download_mode: 1 // 直接进行下载，但是不会发送消息通知
                    // custom_generate: {
                    //  content: "环境保护",
                    //  type: 1
                    // },
                    custom_generate: {
                    content: custom_generate_content,
                    type: 7,
                    step: 2
                    },
                    download_mode: 2  // 直接进行下载，并且发送消息通知，包含可下载地址
                    },
                    onMessage(eventType,data){
                    console.log(eventType,data)
                   }
                   })
                   } catch (e) {  // 进行异常描述的信息捕获
                     console.log(e, 'catch exception')
                   }
               } else {
                console.error('AipptIframe SDK is not loaded');
               }
            })
            .catch(error => {
                console.error('Error:', error);
            });
        };
      
    </script>
</body>
</html>
